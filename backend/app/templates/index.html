{% extends "base.html" %}

{% block title %}Memoro - Your Contacts{% endblock %}

{% block content %}
<!-- Search bar -->
<div class="search-container">
    <input type="text" class="search-input" placeholder="Search contacts..." name="q" hx-get="/ui/search"
        hx-trigger="keyup changed delay:300ms" hx-target="#search-results-container" hx-indicator="#search-loading">
</div>

<!-- Search results (initially hidden) -->
<div id="search-results-container"></div>

<!-- ASCII Art Loading Component -->
<div id="search-loading" class="search-loading htmx-indicator" style="display: none;">
    <div class="ascii-loader">
        <pre>
    üîç Searching...
   /|\
  / | \
 /  |  \
/___|___\
    |
    |
    |
        </pre>
    </div>
    <div class="loading-dots">
        <span>.</span><span>.</span><span>.</span>
    </div>
</div>

<!-- Contact list -->
{% if contacts %}
<div id="contacts-list-container">
    <ul class="contact-list">
        {% for contact in contacts %}
        <li class="contact-item">
            <div>
                <a href="/contacts/{{ contact.id }}" class="contact-name">
                    {{ contact.first_name }} {{ contact.last_name }}
                </a>
                {% if contact.latest_news %}
                <div class="contact-meta">{{ contact.latest_news[:constants.CONTACT_NEWS_PREVIEW_LENGTH] }}{% if
                    contact.latest_news|length > constants.CONTACT_NEWS_PREVIEW_LENGTH %}...{% endif %}</div>
                {% endif %}
            </div>
        </li>
        {% endfor %}
    </ul>

    <!-- Pagination -->
    {% if total_pages > 1 %}
    <div class="pagination">
        {% if page > 1 %}
        <a href="/?page={{ page - 1 }}">prev</a>
        {% endif %}

        {% for p in range(1, total_pages + 1) %}
        {% if p == page %}
        <span class="current">{{ p }}</span>
        {% else %}
        <a href="/?page={{ p }}">{{ p }}</a>
        {% endif %}
        {% endfor %}

        {% if page < total_pages %} <a href="/?page={{ page + 1 }}">next</a>
            {% endif %}
    </div>
    {% endif %}
</div>
{% else %}
<div class="empty-state">
    <p>Where are your friends? ü§î</p>
    <p style="margin-top: 8px; font-size: 9pt;">Press the + button to add your first interaction</p>
</div>
{% endif %}
{% endblock %}

{% block modals %}
{% include 'components/modal.html' %}
{% endblock %}